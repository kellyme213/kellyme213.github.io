<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../../styles.css"> </link>
        <link rel="stylesheet" href="./sampling.css"> </link>
        <meta name = "viewport" content = "width=1000"> </meta>
        <title> TEST </title>
        <meta charset = "UTF-8"> </meta>
    </head>
    
    <body>
        <div class = "header" id = "header">
            <div class = "headerSection">
                <p> <a href = "../../index.html" style = "text-decoration: none; color: white;"> Home </a> </p>
            </div>
        </div>
        <div class = "content">
            <p> <b>WORK IN PROGRESS WORK IN PROGRESS WORK IN PROGRESS WORK IN PROGRESS</b> </p>
            <h1> Intro to Sampling </h1>



            <!--<canvas width = "2000px" height = "1000px" id = "canvas0" style = "width: 500px;"> </canvas>-->


            <p> Before we talk about sampling, let's talk about integrals. Integrals are all about finding the area under a curve. How do we find the area under a curve. Some functions are easy to integrate, the integral can be written in a closed form and we can solve for the exact area under the curve. However, some functions cannot be integraled easily, and we have to solve them analytically. This will allow us to approximate the integral's solution. One way to approximate the integral is to draw rectangles under the funciton, then add up the areas of the triangles to get an approximation. </p>


            <div class = "graph">
                <div class = "splitContent leftSplitContent noLeft">
                    <canvas width = "1000px" height = "1000px" id = "canvas1"> </canvas>
                </div>
                <div class = "splitContent rightSplitContent noRight">
                    <p> <b>The graph of y = 3x<sup>2</sup> from 0 to 1.</b> </p>
                    <p> Exact Area: 1.0 </p>
                    <p id = "label1a"> Approximated Area: </p>
                    <p id = "label1b"> Difference: </p>
                    <p id = "label1c"> Number of Rectangles: </p>
                    <br/>
                    <input type = "range" id = "slider1" min = "1" max = "500" value = "10"/>
                </div>
            </div>

            <p> If you play around with the graph above, you can visually see how to approximate an integral. As the number of rectangles increases, the approximation gets better. In fact, as the number of rectangles used approaches infinity, the approximation approaches the exact solution! This type of approximation is typically reffered to as a Riemann sum. </p>


            <p> But is there a different way to approximate the integral? Instead of evaluating the function at evenly spaced points on the curve, what if we evaluate at randomly selected points? Let's try it! </p>



            <div class = "graph">
                <div class = "splitContent leftSplitContent noLeft">
                    <canvas width = "1000px" height = "1000px" id = "canvas2"> </canvas>
                </div>
                <div class = "splitContent rightSplitContent noRight">
                    <p> <b>The graph of y = 3x<sup>2</sup> from 0 to 1 with random samples.</b> </p>
                    <p> Exact Area: 1.0 </p>
                    <p id = "label2a"> Approximated Area: </p>
                    <p id = "label2b"> Difference: </p>
                    <p id = "label2c"> Number of Rectangles: </p>
                    <br/>
                    <input class = "slider" type = "range" id = "slider2" min = "1" max = "500" value = "10"/>
                    <br/>
                    <div style = "width = 100%; text-align: center">
                        <input type = "checkbox" id = "check2" name = "check2" style = "width: 15px;"/>
                        <label for = "check2" style = "padding-right: 10px"> Align Rectangles </label>
                    </div>
                    <br/>
                    <div style="width = 100%; text-align: center;">
                        <button type = "button" name = "button2" id = "button2" style = "width: 150px"> Evaluate Integral </button>
                    </div>
                </div>
            </div>


            <p> Since we aren't evaluating the function at even intervals anymore, the rectangles overlap in the visualization, so you can check the 'Align Rectangles' box to align the rectangles like in the first visualization. </p>

            <p> The randomly sampled integral estimation gives a slightly different result than the Riemann sum. Like the Riemann sum, the random approximation gets better as the number of samples increases. However, the random approximation varies in how accurate it is. Sometimes the random approximation is closer than the Reimann sum to the true value, sometimes it is further away. </p>


            <p> This error can be visualized using a historgram. </p>
            <!--<textarea id = "t" rows = "5" cols = "50"> </textarea>-->


            <div class = "graph"> 
                <div class = "splitContent leftSplitContent noLeft">
                    <canvas width = "1000px" height = "1000px" id = "canvas3"> </canvas>
                </div>
                <div class = "splitContent rightSplitContent noRight">
                    <p> <b> A histogram showing the error between the randomly approximated area and exact area. </b> </p>

                    <p> Number of Approximations: 500 </p>
                    <p id = "label3a"> Smallest Difference: </p>
                    <p id = "label3b"> Largest Difference: </p>
                    <p id = "label3c"> Samples Per Approximation: </p>
                    <br/>
                    <input class = "slider" type = "range" id = "slider3" min = "1" max = "500" value = "250"/>

                    <div style="width = 100%; text-align: center;">
                        <button type = "button" name = "button3" id = "button3" style = "width: 150px"> Generate Histogram </button>
                    </div>
                    <br/>
                    <p> <i>This graph is expensive to generate, especially for high number of samples, so you'll need to press the 'Generate Histogram' button to render the graph.</i> </p>
                </div>
            </div>

            <p> As you increase the number of samples per approximation, you will notice that the errors converge towards 0. <b>Talk about variance a bit.</b> However, the Riemann Sum also converges towards 0. Which one converges faster?</p>
            
            <div class = "graph">
                <div class = "splitContent leftSplitContent noLeft">
                    <canvas width = "1000px" height = "1000px" id = "canvas5"> </canvas>
                </div>
                <div class = "splitContent rightSplitContent noRight">
                    <p> <b>Variances vs number of samples</b> </p>
                    <p> Red line - Riemann </p>
                    <p> Blue line - Random </p>
                </div>
            </div>

            <p> Based on the graph, we see that the variance of the riemann sum is always smaller than the variance of the random samples. :(. But, can we do better? Of course we can! <b> Maybe do a graph of number of samples vs % of approximations smaller than riemann error. </b></p>

            <h2> Stratified sampling </h2>

            <p> <b> strified s a m p l i n g </b> </p>





            <div class = "graph">
                <div class = "splitContent leftSplitContent noLeft">
                    <canvas width = "1000px" height = "1000px" id = "canvas6"> </canvas>
                </div>
                <div class = "splitContent rightSplitContent noRight">
                    <p> <b>Stratified sampling vs uniform sampling</b> </p>
                    <p id = "label6a"> Number of samples: </p>
                    <br/>
                    <input class = "slider" type = "range" id = "slider6" min = "0" max = "500" value = "100"/>
                    <br/>
                    <div style = "width: 100%; text-align: center;">
                        <div style="margin-left: 150px; text-align: left;">
                        <input type = "radio" name = "radio6" id = "radio6a" style = "width: 15px;">  </input>
                        <label for = "radio6a" style = "padding-right: 10px"> Stratified </label>
                        <br/>
                        <input type = "radio" name = "radio6" id = "radio6b" style = "width: 15px;">  </input>
                        <label for = "radio6b" style = "padding-right: 10px"> Random </label>
                        </div>
                    </div>
                    <br/>
                    <div style="width: 100%; text-align: center;">
                        <button type = "button" name = "button6" id = "button6" style = "width: 150px"> Generate Points </button>
                    </div>
                </div>
            </div>


            <p> As you can see, stratified sampling reduces the clumping and empty spots we see in random sampling. There are a few disadvantages though. THe number of stratified samples must be a multiple of the number of regions that we sample from. This is to ensure that the random samples are uniformly distributed across each region. If there were certain regions that contain more samples than others, we would be <i> biasing </i> the points towards specifc areas of the sample space (more on biasing later). Additionally, if certain sectoins had more points than others, we would start running into the same clumping issues we were trying to avoid from rando sampling. </p>

            <p> In fact, there is some bias in our Riemann sum. <b> Show high frequency graph. </b> </p>

            <div class = "graph">
                <div class = "splitContent leftSplitContent noLeft">
                    <canvas width = "1000px" height = "1000px" id = "canvas7"> </canvas>
                </div>
                <div class = "splitContent rightSplitContent noRight">
                    <p> <b>Stratified sampling vs uniform sampling, </b> </p>
                    <p> <b> Graph of <i>y = 25 * (max(0.7, sin(6 * x)) - 0.7) + 0.5</i> from 0 to 10. </b> </p>
                    <p> Exact Area: 18.11364 </p>
                    <p id = "label7a"> Approximated Area: </p>
                    <p id = "label7b"> Difference: </p>
                    <p id = "label7c"> Number of samples: </p>


                    <br/>
                    <input class = "slider" type = "range" id = "slider7" min = "0" max = "200" value = "10"/>
                    <br/>
                    <div style = "width: 100%; text-align: center;">
                        <div style="margin-left: 150px; text-align: left;">
                        <input type = "radio" name = "radio7" id = "radio7a" style = "width: 15px;">  </input>
                        <label for = "radio7a" style = "padding-right: 10px"> Stratified </label>
                        <br/>
                        <input type = "radio" name = "radio7" id = "radio7b" style = "width: 15px;">  </input>
                        <label for = "radio7b" style = "padding-right: 10px"> Random </label>
                        <br/>
                        <input type = "radio" name = "radio7" id = "radio7c" style = "width: 15px;">  </input>
                        <label for = "radio7c" style = "padding-right: 10px"> Riemann </label>
                        </div>
                    </div>
                    <br/>
                    <div style = "width = 100%; text-align: center">
                        <input type = "checkbox" id = "check7" name = "check7" style = "width: 15px;"/>
                        <label for = "check7" style = "padding-right: 10px"> Align Rectangles </label>
                    </div>
                    <br/>
                    <div style="width: 100%; text-align: center;">
                        <button type = "button" name = "button7" id = "button7" style = "width: 150px"> Evaluate Integral </button>
                    </div>
                </div>
            </div>

            <p> stratified is slightly better than random, </p>

            <div class = "graph">
                <div class = "splitContent leftSplitContent noLeft">
                    <canvas width = "1000px" height = "1000px" id = "canvas8"> </canvas>
                </div>
                <div class = "splitContent rightSplitContent noRight">
                    <p> <b>Variances vs number of samples</b> </p>
                    <p> Red line - Riemann </p>
                    <p> Blue line - Random </p>
                    <p> Green line - Stratified </p>
                </div>
            </div>

            <p> Talk about red line, high frequency function and riemann bias cause it, stratified doesnt really make a difference in this function, both are about the same variance. talk about using stratified in ray tracing for generating rays and sampling from lights and whatnot. </p>


            <h2> Importance Sampling </h2>

            <p> So far, we've been generating random samples that are evenly distributed over the interval from 0 to 1. In other words, each random value was equally likely to appear. What if we change this, so that some values are more likely to appear than others? This leads us to the idea of Probability Distribution Functions, or PDFs. A PDF is a function that describes the relative likelyhood that a random value is chosen. So far, we've been using a uniform PDF, so that all numbers are equally likely to appear. Before we construct a new PDF, let's talk about some properties of PDFs. </p>

            <p> <b> Bullets </b> PDF is defined over the interval [0, 1]. The integral of the PDF from 0 to 1 = 1 (normalized PDF).</p>

            <p> We can take the integral of a PDF to obtain a CDF - Cumulative Distribution Function. While PDF(x) defines the relative probability of x being selected, CDF(x) is the amount of samples less than x that are generated. CDF(0) = 0, PDF(1) = 1. </p>

            <p> We've currently been using a PDF of y = 1. Let's define a PDF of y = 2x. How do we generate numbers to follow the PDF? We will use Inverse Transorm Sampling.</p>

            <p> 1. create a normalized PDF, y = PDF(x). 2. Create the CDF, y = CDF(x). 3. Invert the CDF y = CDF-1(x). 4. Generate a random sample from a uniform PDF, u. plug in u into CDF-1, the output will be distributed along the PDF.</p>

            <p> As an example, let's use y = 2x as a PDF. The integral of 2x is x2. The inverse of x2 is sqrt(x). So, if we generate a random number u, sqrt(u) will be distributed along the PDF. Unfortunately, not all PDFs can be easily inverted like this, so we have to do approximations in that case, which is much more expensive than the y = 2x case. However, it can be done. </p>

            <div class = "graph">
                <div class = "splitContent leftSplitContent noLeft">
                    <canvas width = "1000px" height = "1000px" id = "canvas9"> </canvas>
                </div>
                <div class = "splitContent rightSplitContent noRight">
                    <p> <b>PDF, CDF, Inverse Sampling</b> </p>
                    <p id = "label9a"> Number of Points: </p>
                    <br/>
                    <input class = "slider" type = "range" id = "slider9" min = "0" max = "50" value = "10"/>
                    <br/>
                    <div style = "">
                        <div style = "width: 49%; display: inline-block; vertical-align: top;">
                            <p> <b> PDF </b> </p>
                            <input type = "radio" name = "radio9" id = "radio9a" style = "width: 15px;">  </input>
                            <label for = "radio9a" style = "padding-right: 10px"> y = 1 </label>
                            <br/>
                            <input type = "radio" name = "radio9" id = "radio9b" style = "width: 15px;">  </input>
                            <label for = "radio9b" style = "padding-right: 10px"> y = 2x </label>
                            <br/>
                            <input type = "radio" name = "radio9" id = "radio9c" style = "width: 15px;">  </input>
                            <label for = "radio9c" style = "padding-right: 10px"> y = {0 if 0.2 < x < 0.8, 2.5 otherwise} </label>
                            <br/>
                        </div>
                        <div style = "width: 49%; display: inline-block; vertical-align: top;">
                            <p> <b>Display Options</b> </p>
                            <input type = "checkbox" name = "check9" id = "check9a" style = "width: 15px;">  </input>
                            <label for = "check9a" style = "padding-right: 10px"> PDF (Red Line) </label>
                            <br/>
                            <input type = "checkbox" name = "check9" id = "check9b" style = "width: 15px;">  </input>
                            <label for = "check9b" style = "padding-right: 10px"> CDF (Blue Line) </label>
                            <br/>
                            <input type = "checkbox" name = "check9" id = "check9c" style = "width: 15px;">  </input>
                            <label for = "check9c" style = "padding-right: 10px"> Points </label>
                            <br/>
                        </div>
                    </div>
                </div>
            </div>



            <br/>
            <br/>            <br/>
            <br/>            <br/>
            <br/>            <br/>
            <br/>            <br/>
            <br/>            <br/>
            <br/>            <br/>
            <br/>            <br/>
            <br/>            <br/>
            <br/>

            <div class = "graph">
                <div class = "splitContent leftSplitContent noLeft">
                    <canvas width = "1000px" height = "1000px" id = "canvas4"> </canvas>
                </div>
                <div class = "splitContent rightSplitContent noRight">
                    <p> <b>The graph of y = 2x * g(x) from 0 to 3 randomly sampled with pdf of 2x.</b> </p>
                    <p> Exact Area: 11.793940 </p>
                    <p id = "label4a"> Approximated Area: </p>
                    <p id = "label4b"> Difference: </p>
                    <p id = "label4c"> Number of Rectangles: </p>
                    <br/>
                    <input class = "slider" type = "range" id = "slider4" min = "1" max = "500" value = "10"/>
                    <br/>
                    <div style = "width: 100%; text-align: center">
                        <input type = "checkbox" id = "check4" name = "check4" style = "width: 15px;"/>
                        <label for = "check4" style = "padding-right: 10px"> Align Rectangles </label>
                    </div>
                    <br/>
                    <div style="width: 100%; text-align: center;">
                        <button type = "button" name = "button4" id = "button4" style = "width: 150px"> Evaluate Integral </button>
                    </div>
                </div>
            </div>










            <br/>
            <br/>
            <script src = "graphConstants.js"> </script>
            <script src = "math.js"> </script>
            <script src = "pdf.js"> </script>            
            <script src = "histogram.js"> </script>
            <script src = "graph.js"> </script>
            <script src = "main.js"> </script>



        </div>
        
        
        
        <div class = "footer">
            <p> TEST </p>
            <a href = "../../index.html"> <img src = "../../pictures/logo-white.png"> </img> </a>
            <div class = "linkBox">
                <a href = "../../index.html"> Home </a>
            </div>
        </div>
        <script type = "text/javascript" src = "../../scripts/footer.js"> </script>
        
    </body>
</html>



<!--
 <div class = "heading">
 <a>  </a>
 <a style = "float:right">  </a>
 <p>  </p>
 </div>
 -->
